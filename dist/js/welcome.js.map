{"version":3,"sources":["js/welcome.js"],"names":["profileUrl","token","provider","getProfile","_ref","fetchLambda","getProfileSuccess","json","el$","authorizing","welcome","profilePicture","profileName","baseGrantUrl","addClass","removeClass","src","picture","innerHTML","name","email","href","getProfileError","err","console","error","main","document","window","ids","parameters","getElementsById","query","getParameters","location","then","catch"],"mappings":"YAMA,IAAMA,YAAa,SAACC,EAAOC,GAAR,MAAA,qFACmED,EADnE,aACqFC,GAQlGC,WAAa,SAAAC,GAAA,GAAEH,GAAFG,EAAEH,MAAOC,EAATE,EAASF,QAAT,OAClBG,aAAYL,WAAWC,EAAOC,KAWzBI,kBAAoB,SAACC,EAAMC,GAChC,GAAKD,GAASC,EAAd,CADwC,GAEjCC,GAAmED,EAAnEC,YAAaC,EAAsDF,EAAtDE,QAASC,EAA6CH,EAA7CG,eAAgBC,EAA6BJ,EAA7BI,YAAaC,EAAgBL,EAAhBK,YACpDJ,IAAiBC,IACtBI,SAASL,EAAa,UACtBM,YAAYL,EAAS,WAJjBC,IADmCA,EAAAK,IAEjCT,EAAAU,SAFiC,6BAEpBL,IAFoBA,EAEXM,UAAAX,EAAAY,MAAAZ,EAFWa,OAAA,IAEKP,IAFLA,EAEkBQ,KAAgBd,EAAhBM,gBAY3DS,gBAAA,SAAAC,EAAAf,GASCgB,QAAQC,MAAMF,GACRf,EAAA,cAAyBA,EAAA,eAC9BM,SAASN,EAAA,YAAoB,UAC7BO,YAAYP,EAAA,aAAqB,YAgB7BkB,KAAO,SAACC,EAAUC,GAEvB,KAAI,WAEH,GAAMC,IACL,UACA,cACA,OAPH,gBACC,iBACA,cAAI,eACH,gBAWMC,GAIN,WACA,SAEAtB,EAAAuB,gBAAyBF,EAAAF,GACzBK,EAAaC,cAAbH,EAAoCF,EAAAM,SAApCb,KAEAN,aAAAP,EAAA,KAAA,aACAM,SAAAN,EAAA,KAAA,QACOwB,EAAA,UAAAlB,SAAQN,EAAA,cAAAwB,EAAA,UACP7B,WAAO6B,GAFfG,KAAA,SAAA5B,GAAA,MAAAD,mBAAAC,EAAAC,KAvBG4B,MAAA,SAAAb,GAAA,MAAAD,iBAAAC,EAAAf,QA0BF,MAAOe,GACRC,QAAQC,MAAMF,IAMhBG,MAAKC,SAAUC","file":"js/welcome.js","sourcesContent":["/**\n * Builds the profile url from the provider and token values.\n * @param  {String} token    Token value.\n * @param  {String} provider Provider value.\n * @return {String}          Provider Lambda URL.\n */\nconst profileUrl = (token, provider) =>\n\t`https://kvmveb8o06.execute-api.us-east-1.amazonaws.com/dev/authentication/profile/${token}?provider=${provider}`\n/**\n * Calls the Lambda endpoint for the user profile.\n * If fetch() is undefined it returns.\n * @param  {String} options.token    Token value.\n * @param  {String} options.provider Provider value.\n * @return {Promise}                 Profile call promise.\n */\nconst getProfile = ({token, provider}) => \n\tfetchLambda(profileUrl(token, provider))\n/**\n * If the user profile is returned, update the welcome page:\n *  - hide authenticating spinner.\n *  - show welcome section.\n *  - set the user name.\n *  - set the user profile.\n * @param  {Object} json User profile json information.\n * @param  {Object} el$  Object of page elements.\n * @return {Void}\n */\nconst getProfileSuccess = (json, el$) => {\n\tif (!json || !el$) return\n\tconst {authorizing, welcome, profilePicture, profileName, baseGrantUrl} = el$\n\tif (!!authorizing && !!welcome) {\n\t\taddClass(authorizing, 'hidden')\n\t\tremoveClass(welcome, 'hidden')\n\t}\n\tif (!!profilePicture)\n\t\tprofilePicture.src = json.picture || 'http://placehold.it/50x50'\n\tif (!!profileName)\t\n\t\tprofileName.innerHTML = json.name || json.email || ''\n\tif (!!baseGrantUrl)\n\t\tbaseGrantUrl.href = json.baseGrantUrl\n}\n/**\n * If an error is returned from getProfile() call:\n * - hide authorizing spinner.\n * - show error message.\n * @param  {Error}  err Lambda error.\n * @param  {Object} el$ Object of page elements.\n * @return {Void}\n */\nconst getProfileError = (err, el$) => {\n\tconsole.error(err)\n\tif (!!el$['errorMessage'] && !!el$['errorMessage']) {\n\t\taddClass(el$['authorizing'], 'hidden')\n\t\tremoveClass(el$['errorMessage'], 'hidden')\n\t}\n}\n/**\n * Main page function.\n * - gets the required page elements.\n * - gets the query values from the url.\n * - sets the authenticating spinner icon.\n * - calls the getProfile() method.\n *  - if the response is successful call getProfileSuccess()\n *  - if the response is no successful call getProfileError()\n *  - pass the list of page elements. \n * @param  {Object} document Page document object-\n * @param  {Object} window   Page window object.\n * @return {Void}\n */\nconst main = (document, window) => {\n\t// Log error\n\ttry {\n\t\t// Setup\n\t\tconst ids = [\n\t\t\t'welcome',\n\t\t\t'authorizing',\n\t\t\t'icon',\n\t\t\t'iconContainer',\n\t\t\t'profilePicture',\n\t\t\t'profileName',\n\t\t\t'errorMessage',\n\t\t\t'baseGrantUrl',\n\t\t]\n\t\tconst parameters = [\n\t\t\t'provider',\n\t\t\t'token',\n\t\t]\n\t\tconst el$ = getElementsById(ids, document)\n\t\tconst query = getParameters(parameters, window.location.href)\n\t\t// Set the authenticating spinner icon.\n\t\tremoveClass(el$['icon'], 'icon-wifi')\n\t\taddClass(el$['icon'], `icon-${query['provider']}`)\n\t\taddClass(el$['iconContainer'], query['provider'])\n\t\t// Get the user profile.\n\t\tgetProfile(query)\n\t\t\t.then(json => getProfileSuccess(json, el$))\n\t\t\t.catch(err => getProfileError(err, el$))\n\t} catch (err) {\n\t\tconsole.error(err)\n\t}\n}\n/**\n * Main page function.\n */\nmain(document, window)\n"],"sourceRoot":"/source/"}