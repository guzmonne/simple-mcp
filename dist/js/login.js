"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var n=0,r=Array(e.length);n<e.length;n++)r[n]=e[n];return r}return Array.from(e)}var mainUrl="https://kvmveb8o06.execute-api.us-east-1.amazonaws.com/dev",signupUrl=mainUrl+"/authentication/signup",signinUrl=mainUrl+"/authentication/login",toggleSections=function(e){var n=e.signupSection,r=e.signinSection,t=e.socialSection;n&&toggleClass(n,"hidden"),r&&toggleClass(r,"hidden"),t&&toggleClass(t,"hidden")},toggleButtons=function(){return map(document.forms,function(e){return map([].concat(_toConsumableArray(e.getElementsByTagName("button")),_toConsumableArray(e.getElementsByTagName("a"))),function(e){return toggleClass(e,"hidden")})})},toggleForm=function(e){map(document.forms,function(e){return map(e.getElementsByClassName("form-control"),function(e){return e.disabled=!e.disabled})}),toggleButtons(),hideAlerts(e)},hideAlerts=function(e){var n=e.mandatoryFieldsAlert,r=e.userExistsAlert;n&&!hasClass(n,"hidden")&&addClass(n,"hidden"),r&&!hasClass(r)&&addClass(r,"hidden")},showAlert=function(e){return removeClass(e,"hidden")},getUserDataFromSignupForm=function(e){var n=e.name,r=e.email,t=e.password,o=e.age,i=e.maleRadio,a=e.femaleRadio;return Promise.resolve({name:n.value,email:r.value,password:t.value,age:JSON.parse(o.options[o.selectedIndex].value),gender:i.checked?"male":a.checked?"female":void 0})},getUserDataFromLoginForm=function(e){var n=e.loginForm;return Promise.resolve(map(n.getElementsByClassName("form-control"),function(e){return _defineProperty({},e.name,e.value)}).reduce(function(e,n){return Object.assign(e,n)},{}))},validateData=function(e){var n=Object.keys(e).map(function(n){return isEmpty(e[n])}).reduce(function(e,n){return e||n},!1);return n?Promise.reject(new Error("Todos los campos son obligatorios.")):Promise.resolve(e)},signupUser=function(e){return fetchJSONLambda(signupUrl,e)},signinUser=function(e){return fetchJSONLambda(signinUrl,e)},loginUser=function(e,n){n.preventDefault(),toggleForm(e),getUserDataFromLoginForm(e).then(function(e){return validateData(e)}).then(function(e){return signinUser(e)}).then(lambdaCallSuccess.bind(null,e)).catch(loginUserError.bind(null,e))},loginUserError=function(e,n){console.error(n),toggleForm(e)},createUser=function(e,n){n.preventDefault(),toggleForm(e),getUserDataFromSignupForm(e).then(function(e){return validateData(e)}).then(function(e){return signupUser(e)}).then(lambdaCallSuccess.bind(null,e)).catch(createUserError.bind(null,e))},lambdaCallSuccess=function(e,n){console.log(n),toggleForm(e),window.location.href=n},createUserError=function(e,n){console.error(n);var r=e.userExistsAlert,t=e.mandatoryFieldsAlert;toggleForm(e),"Todos los campos son obligatorios."===n.message&&showAlert(t),"email is in use"===n.message&&showAlert(r)},main=function(e,n){try{var r=["signupSection","signinSection","socialSection","signupForm","loginForm","showSigninSection","showSignupSection","name","email","password","maleRadio","femaleRadio","age","spinButton","createButton","mandatoryFieldsAlert","userExistsAlert"],t=getElementsById(r,e),o=toggleSections.bind(void 0,t),i=createUser.bind(void 0,t),a=loginUser.bind(void 0,t);addEventListener(t.showSigninSection,"click",o),addEventListener(t.showSignupSection,"click",o),addEventListener(t.signupForm,"onsubmit",i),addEventListener(t.loginForm,"onsubmit",a)}catch(e){console.error(e)}};main(document,window);
//# sourceMappingURL=login.js.map
